generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Player {
  id             String           @id @default(uuid())
  name           String
  grip           Grip             @relation(fields: [gripId], references: [id])
  Rating         Rating[]
  Match          Match[]
  PlayersMatches PlayersMatches[]
  gripId         Int
}

model Rating {
  id        Int      @id @default(autoincrement())
  score     Int
  createdAt DateTime @default(now())
  player    Player   @relation(fields: [playerId], references: [id])
  playerId  String
}

model Match {
  id             Int              @id @default(autoincrement())
  type           String           @default("single")
  createdAt      DateTime         @default(now())
  startedAt      DateTime         @default(now())
  PlayersMatches PlayersMatches[]
  Game           Game[]
  Player         Player?          @relation(fields: [playerId], references: [id])
  playerId       String?
}

model PlayersMatches {
  player   Player @relation(fields: [playerId], references: [id])
  match    Match  @relation(fields: [matchId], references: [id])
  playerId String
  matchId  Int

  @@id([playerId, matchId])
}

model Game {
  id        Int      @id @default(autoincrement())
  points    String // 2x11
  match     Match    @relation(fields: [matchId], references: [id])
  matchId   Int
  createdAt DateTime @default(now())
}

model Grip {
  id     Int      @id @default(autoincrement())
  title  String
  Player Player[]
}
